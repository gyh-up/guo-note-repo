# 堆

## 堆的性质

堆是一种特殊的[二叉树](/classify/algorithm/concept/数据结构-树#完全二叉树)，具有一些特殊的性质。

- 堆中某个节点的值总是不大于或不小于其父节点的值。我们把子节点都不大于父节点的称为大堆，反之称为小堆。
- 堆总是一棵完全二叉树。

## 堆的插入

堆的插入要求插入新数据后依然为一个堆。我们使用**上浮算法**对新数据的位置进行调整（大堆为例，下标从 1 开始，当前节点位置为 k，堆的元素有 n 个）。

1. 在堆的尾部插入一个元素（k = n + 1）
2. 循环比较当前插入的节点和其父节点的值大小（k 和 k/2，每次循环记得给 k 赋新值）
   - 若当前插入节点下标等于 1，说明已经到达根节点，跳出循环
   - 若当前插入节点值小于其父节点的值，跳出循环，无需调整
   - 若当前插入节点值大于其父节点的值，交换两节点，k 值上浮（k = k/2）

**注意：插入时只能在堆的末尾进行操作，否则会破坏堆的整个结构。**

## 堆的删除

堆的删除要求在原有堆的基础上，删掉第一个元素，通过调整，形成新的堆。

如果只是简单的直接删除，会使堆的整个结构发生错乱（例如分裂成两棵二叉树）。我们使用**下沉算法**对新数据的位置进行调整（大堆为例，下标从 1 开始，当前节点位置为 k，堆的元素有 n 个）。

1. 交换根节点和最后一个节点
2. 删除最后一个节点，即步骤 1 的根节点
3. 从根节点开始，比较当前节点和其左右子节点的值大小（k 、 k/2、k/2 +1，每次循环记得给 k 赋新值）
   - 若当前插入节点下标大于 n，说明已经超出最后一个元素，跳出循环
   - 若当前插入节点值大于其左右子节点的值，跳出循环，无需调整
   - 若当前插入节点值小于其左子节点的值，交换两节点，k 值下沉（k = k/2）
   - 若当前插入节点值小于其右子节点的值，交换两节点，k 值下沉（k = k/2 + 1）

